import matplotlib.pyplot as plt

import numpy as np


# Re-define full updated data for DBSCAN clustering (Network Embedding, 100 patients)
dbscan_network_scores_100_full = {
    0: 0.709183673469387, 1: 1.0, 2: 0.8800000000000001, 3: 0.39999999999999997, 4: 0.375,
    5: 0.825, 6: 0.9285714285714286, 7: 1.0, 8: 0.598168498168498, 9: 0.6851851851851853,
    10: 0.9, 11: 0.6574074074074074, 12: 1.0, 13: 0.6087912087912086, 14: 0.7624999999999998,
    15: 0.6535303776683087, 16: 0.71875, 17: 0.6458333333333334, 18: 1.0, 19: 0.7333333333333334,
    20: 0.8999999999999999, 21: 0.9523809523809524, 22: 0.8848133848133847, 23: 0.9880952380952381,
    24: 0.9705882352941176, 25: 0.7962962962962963, 26: 1.0, 27: 1.0, 28: 1.0, 29: 0.95,
    30: 0.8666666666666667, 31: 0.9, 32: 0.8285714285714286, 33: 0.8467120181405893,
    34: 0.7445222186870296, 35: 0.4405472636815939, 36: 0.6000000000000001, 37: 0.7223241590214057,
    38: 0.55, 39: 0.9415584415584418, 40: 0.9428571428571428, 41: 0.9795918367346939,
    42: 0.5982142857142859, 43: 0.47619047619047616, 44: 0.3756613756613756, 45: 0.2933333333333332,
    46: 0.8928571428571429, 47: 0.8095238095238096, 48: 0.5428571428571428, 49: 0.7177700348432057,
    50: 0.987012987012987, 51: 0.9473684210526317, 52: 0.8163265306122448, 53: 0.7333333333333334,
    54: 0.8277777777777778, 55: 0.71875, 56: 0.6388888888888888, 57: 0.6571428571428571,
    58: 0.8800000000000001, 59: 0.8222222222222223, 60: 0.623529411764706, 61: 0.9333333333333333,
    62: 0.9833333333333334, 63: 0.846153846153846, 64: 1.0, 65: 0.7564102564102565, 66: 0.9,
    67: 0.6666666666666666, 68: 0.5416666666666666, 69: 0.8897243107769426, 70: 0.9642857142857144,
    71: 0.9761904761904763, 72: 0.9740259740259741, 73: 0.8794372294372292, 74: 1.0, 75: 0.784126984126984,
    76: 0.9365079365079367, 77: 0.9160997732426305, 78: 0.9319727891156463, 79: 0.9591836734693878,
    80: 0.7857142857142856, 81: 0.8742857142857143, 82: 0.6142857142857141, 83: 0.9206349206349205,
    84: 0.7755102040816325, 85: 0.6111111111111109, 86: 0.3333333333333333, 87: 0.7142857142857143,
    88: 0.9831932773109244, 89: 0.6946169772256728, 90: 1.0, 91: 0.7158730158730157, 92: 0.6666666666666666,
    93: 0.7499999999999999, 94: 0.63913043478261, 95: 0.525, 96: 0.7557017543859651, 97: 0.9583333333333334,
    98: 1.0, 99: 0.7282608695652174, 100: 0.6104651162790697, 101: 0.888888888888889, 102: 0.6666666666666666,
    103: 0.6666666666666666, 104: 0.8888888888888888, 105: 0.6888888888888888, 106: 0.6666666666666666,
    107: 1.0, 108: 0.9211822660098522, 109: 0.8571428571428572, 110: 0.5918367346938774, 111: 1.0,
    112: 1.0, 113: 0.9340659340659341, 114: 0.8670634920634924, 115: 0.5714285714285713, 116: 0.8511904761904762,
    117: 0.6462585034013605, 118: 0.6285714285714284, 119: 0.9285714285714286, 120: 0.825, 121: 0.925,
    122: 1.0, 123: 1.0, 124: 1.0, 125: 0.8456790123456789, 126: 1.0, 127: 0.7959183673469393,
    128: 1.0, 129: 1.0, 130: 1.0, 131: 1.0, 132: 1.0, 133: 1.0, 134: 1.0, 135: 1.0, 136: 1.0,
    137: 0.7582417582417584, 138: 0.6666666666666665, 139: 1.0, 140: 1.0, 141: 0.8518518518518521,
    142: 1.0, 143: 0.7882352941176469, 144: 0.9090909090909091, 145: 0, 146: 0, 147: 0, 148: 0
}

# Extract full cluster labels and scores for DBSCAN (Network Embedding, 100 patients)
dbscan_network_labels_100_full = list(dbscan_network_scores_100_full.keys())
dbscan_network_scores_values_100_full = list(dbscan_network_scores_100_full.values())

# Create log plot for full updated DBSCAN clustering (Network Embedding, 100 patients)
plt.figure(figsize=(14, 8))
plt.plot(dbscan_network_labels_100_full, dbscan_network_scores_values_100_full, 
         marker='o', markersize=6, label='DBSCAN Scores (Network Embedding)', color='orange', linestyle='-')

# Add plot details
plt.xscale('log')
plt.title('Full Updated DBSCAN Cluster Scores for 100 Patients (Network Embedding)', fontsize=16)
plt.xlabel('Cluster Labels (Log Scale)', fontsize=14)
plt.ylabel('Cluster Scores', fontsize=14)
plt.axhline(y=np.mean(dbscan_network_scores_values_100_full), color='r', linestyle='--', label=f'Mean Score: {np.mean(dbscan_network_scores_values_100_full):.2f}')

# Add annotation with updated parameters and cluster details
text_box_full = (
    "eps=1.2, min_samples=5\n"
    "Number of clusters: 149\n"
    "Number of noise points: 2051\n"
    "Total number of nodes: 5520"
)
plt.text(1, 0.1, text_box_full, fontsize=12, color='blue', bbox=dict(facecolor='white', alpha=0.7, edgecolor='blue'))

plt.grid(True, which="both", linestyle='--', linewidth=0.5)
plt.legend(fontsize=12)

# Save and display the full updated plot
plt.tight_layout()
plt.savefig('/home/project/matching/Results/DBSCAN_Cluster_Scores_100_Patients_Network_Embedding.png')
plt.show()
